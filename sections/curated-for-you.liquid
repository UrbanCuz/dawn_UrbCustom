{{ 'curated-for-you.css' |  asset_url | stylesheet_tag }}

{% style %}
    .section-{{ section.id }}-padding {
        padding-top: {{ section.settings.padding_top | times: 0.75 | round : 0 }}px;
        padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round : 0 }}px;
    }

    @media screen and (min-width: 750px) {
        .section-{{ section.id }}-padding {
            padding-top: {{ section.settings.padding_top }}px;
            padding-bottom: {{ section.settings.padding_bottom }}px;
        }
    }
{% endstyle %}

<div class="section-{{ section.id }}-padding">
    <div class="page-width">
        {% if section.settings.title != blank %}
            <h2 class="curated-for-you__heading text center">{{ section.settings.title }}</h2>
        {% endif %}

        {% if section.settings.collection != blank %}
            {% assign collection = collections[section.settings.collection] %}

            {% if collection.products.size > 0 %}
                <div class="glide">
                    <div class="glide__track" data-glide-el="track">
                        <ul class="glide__slides">
                            {% for product in collection.products limit: 7 %}
                                <li class="glide__slide">
                                    <a href="{{ product.url }}">
                                        <img src="{{ product.featured_image | img_url: 'master' }}" 
                                            alt="{{ product.featured_image.alt | escape }}" 
                                            class="product-image" 
                                            loading="lazy"
                                            width="auto"
                                            height="auto">
                                        <h3 class="product-title">{{ product.title }}</h3>
                                    </a>
                                </li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>

                <div class="glide__arrows" data-glide-el="controls">
                    <button class="glide__arrow glide__arrow--left" data-glide-dir="<">Previous</button>
                    <button class="glide__arrow glide__arrow--right" data-glide-dir=">">Next</button>
                </div>
            {% else %}
                <p>No products found in the "{{ collection.title }}" collection.</p>
            {% endif %}
        {% else %}
            <p>Please select a collection in the theme editor.</p>
        {% endif %}
    </div>
</div>

{% schema %}
    {
        "name": "Curated for you",
        "settings": [
            {
                "type": "text",
                "id": "title",
                "label": "Section Title",
                "default": "Curated for you"
            },
            {
                "type": "collection",
                "id": "collection",
                "label": "Select Collection"
            },
            {
                "type": "checkbox",
                "id": "show_vendor",
                "label": "Show Vendor",
                "default": false
            },
            {
                "type": "checkbox",
                "id": "show_rating",
                "label": "Show Rating",
                "default": true
            },
            {
                "type": "header",
                "content": "t:sections.all.padding.section_padding_heading"
            },
            {
                "type": "range",
                "id": "padding_top",
                "min": 0,
                "max": 100,
                "step": 4,
                "label": "t:sections.all.padding.padding_top",
                "default": 36
            },
            {
                "type": "range",
                "id": "padding_bottom",
                "min": 0,
                "max": 100,
                "step": 4,
                "label": "t:sections.all.padding.padding_bottom",
                "default": 36
            }
            ],
            "presets": [
                {
                    "name": "t:sections.curated_for_you.name"
                }
                ]
    }
{% endschema %}